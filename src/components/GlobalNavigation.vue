<template>
    <nav class="bg-white border-2 border-[#0A0910] max-w-7xl mx-auto rounded-lg mb-4 shadow-lg">
        <div class="px-4 py-6 md:px-6">
            <!-- Ê°åÈù¢Á´ØÂØºËà™ -->
            <div class="hidden md:flex items-center justify-between">
                <!-- LogoÂå∫Âüü -->
                <router-link to="/" class="flex items-center gap-3 transition-transform duration-200" @click="rotateLogo">
                    <div
                        class="w-12 h-12 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-lg flex items-center justify-center border-2 border-[#0A0910]"
                        :class="{ 'rotate-logo': isLogoRotating }"
                    >
                        <span class="text-white text-xl font-bold">È•≠</span>
                    </div>
                    <div>
                        <div class="text-2xl font-black text-dark-800 tracking-wider">
                            {{ pageTitle }}
                        </div>
                        <div class="text-xs text-gray-600 font-medium">{{ pageSubtitle }}</div>
                    </div>
                </router-link>

                <!-- ÂØºËà™ËèúÂçï -->
                <div class="flex items-center gap-2">
                    <!-- ËÆæÁΩÆÊåâÈíÆ -->
                    <SettingsButton />
                    <!-- ‰∏ªË¶ÅÂäüËÉΩ -->
                    <router-link
                        to="/"
                        class="flex items-center gap-1 px-3 py-2 rounded-lg font-bold border-2 border-[#0A0910] transition-all duration-200 transform hover:scale-105 text-sm"
                        :class="$route.path === '/' ? 'bg-yellow-400 text-gray-800' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'"
                    >
                        <span>üè†</span>
                        <span>‰∏ªÈ°µ</span>
                    </router-link>
                    <router-link
                        to="/today-eat"
                        class="flex items-center gap-1 px-3 py-2 rounded-lg font-bold border-2 border-[#0A0910] transition-all duration-200 transform hover:scale-105 text-sm"
                        :class="$route.path === '/today-eat' ? 'bg-yellow-400 text-gray-800' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'"
                    >
                        <span>üé≤</span>
                        <span>ÁæéÈ£üÁõ≤Áõí</span>
                    </router-link>
                    <router-link
                        to="/table-design"
                        class="flex items-center gap-1 px-3 py-2 rounded-lg font-bold border-2 border-[#0A0910] transition-all duration-200 transform hover:scale-105 text-sm"
                        :class="$route.path === '/table-design' ? 'bg-yellow-400 text-gray-800' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'"
                    >
                        <span>üçΩÔ∏è</span>
                        <span>Êª°Ê±âÂÖ®Â∏≠</span>
                    </router-link>
                    <router-link
                        to="/fortune-cooking"
                        class="flex items-center gap-1 px-3 py-2 rounded-lg font-bold border-2 border-[#0A0910] transition-all duration-200 transform hover:scale-105 text-sm"
                        :class="$route.path === '/fortune-cooking' ? 'bg-yellow-400 text-gray-800' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'"
                    >
                        <span>üîÆ</span>
                        <span>ÁéÑÂ≠¶Âé®Êàø</span>
                    </router-link>
                    <router-link
                        to="/sauce-design"
                        class="flex items-center gap-1 px-3 py-2 rounded-lg font-bold border-2 border-[#0A0910] transition-all duration-200 transform hover:scale-105 text-sm"
                        :class="$route.path === '/sauce-design' ? 'bg-yellow-400 text-gray-800' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'"
                    >
                        <span>ü•Ñ</span>
                        <span>ÈÖ±ÊñôÂ§ßÂ∏à</span>
                    </router-link>

                    <!-- Êõ¥Â§öËèúÂçï‰∏ãÊãâ -->
                    <div class="relative" @mouseleave="handleMouseLeave">
                        <button
                            @mouseenter="handleMouseEnter"
                            @click="showMoreMenu = !showMoreMenu"
                            :class="[
                                'flex items-center gap-1 px-3 py-2 rounded-lg font-bold border-2 border-[#0A0910] transition-all duration-200 transform hover:scale-105 text-sm',
                                isMoreMenuActive ? 'bg-yellow-400 text-gray-800' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                            ]"
                        >
                            <span>‚ãØ</span>
                            <span>Êõ¥Â§ö</span>
                        </button>

                        <!-- ‰∏ãÊãâËèúÂçï -->
                        <div
                            v-if="showMoreMenu"
                            @mouseenter="handleMouseEnter"
                            class="absolute right-0 top-full mt-0.5 w-40 bg-white border-2 border-[#0A0910] rounded-lg shadow-lg z-50 overflow-hidden"
                        >
                            <router-link
                                to="/favorites"
                                @click="showMoreMenu = false"
                                class="flex items-center gap-2 px-4 py-3 text-sm font-bold transition-colors duration-200 hover:bg-gray-100"
                                :class="$route.path === '/favorites' ? 'bg-yellow-100 text-gray-800' : 'text-gray-700'"
                            >
                                <span>‚ù§Ô∏è</span>
                                <span>ÊàëÁöÑÊî∂Ëóè</span>
                            </router-link>
                            <router-link
                                to="/gallery"
                                @click="showMoreMenu = false"
                                class="flex items-center gap-2 px-4 py-3 text-sm font-bold transition-colors duration-200 hover:bg-gray-100"
                                :class="$route.path === '/gallery' ? 'bg-yellow-100 text-gray-800' : 'text-gray-700'"
                            >
                                <span>üñºÔ∏è</span>
                                <span>Â∞ÅÁ•ûÂõæÈâ¥</span>
                            </router-link>
                            <router-link
                                to="/about"
                                @click="showMoreMenu = false"
                                class="flex items-center gap-2 px-4 py-3 text-sm font-bold transition-colors duration-200 hover:bg-gray-100"
                                :class="$route.path === '/about' ? 'bg-yellow-100 text-gray-800' : 'text-gray-700'"
                            >
                                <span>üìñ</span>
                                <span>ÂÖ≥‰∫éÊàë‰ª¨</span>
                            </router-link>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ÁßªÂä®Á´ØÂØºËà™ -->
            <div class="md:hidden">
                <!-- È°∂ÈÉ®LogoÂíåËèúÂçïÊåâÈíÆ -->
                <div class="flex items-center justify-between">
                    <router-link to="/" class="flex items-center gap-2" @click="rotateLogo">
                        <div
                            class="w-10 h-10 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-lg flex items-center justify-center border-2 border-[#0A0910]"
                            :class="{ 'rotate-logo': isLogoRotating }"
                        >
                            <span class="text-white text-lg font-bold">È•≠</span>
                        </div>
                        <div>
                            <div class="text-lg font-black text-dark-800 tracking-wider">
                                {{ pageTitle }}
                            </div>
                            <div class="text-xs text-gray-600 font-medium">{{ pageSubtitle }}</div>
                        </div>
                    </router-link>
                    <div class="flex items-center gap-2">
                        <!-- ÁßªÂä®Á´ØËÆæÁΩÆÊåâÈíÆ -->
                        <SettingsButton />
                        <button @click="showMobileMenu = !showMobileMenu" class="p-2 bg-gray-100 hover:bg-gray-200 rounded-lg border-2 border-[#0A0910] transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- ÁßªÂä®Á´ØËèúÂçï - Ê®™ÂêëÊªöÂä®Ê†áÁ≠æÊ†è -->
                <div v-if="showMobileMenu" class="border-t-2 border-gray-200 pt-3 mt-3">
                    <!-- Ê®™ÂêëÊªöÂä®ÂØºËà™ -->
                    <div class="overflow-x-auto scrollbar-hide">
                        <div class="flex gap-2 pb-2 min-w-max">
                            <router-link
                                to="/"
                                @click="showMobileMenu = false"
                                class="flex items-center gap-1.5 px-3 py-2 rounded-full font-bold border-2 border-[#0A0910] transition-all duration-200 whitespace-nowrap text-sm"
                                :class="$route.path === '/' ? 'bg-yellow-400 text-gray-800 shadow-md' : 'bg-white text-gray-700 hover:bg-gray-50 active:scale-95'"
                            >
                                <span>üè†</span>
                                <span>‰∏ªÈ°µ</span>
                            </router-link>
                            <router-link
                                to="/today-eat"
                                @click="showMobileMenu = false"
                                class="flex items-center gap-1.5 px-3 py-2 rounded-full font-bold border-2 border-[#0A0910] transition-all duration-200 whitespace-nowrap text-sm"
                                :class="$route.path === '/today-eat' ? 'bg-yellow-400 text-gray-800 shadow-md' : 'bg-white text-gray-700 hover:bg-gray-50 active:scale-95'"
                            >
                                <span>üé≤</span>
                                <span>ÁæéÈ£üÁõ≤Áõí</span>
                            </router-link>
                            <router-link
                                to="/table-design"
                                @click="showMobileMenu = false"
                                class="flex items-center gap-1.5 px-3 py-2 rounded-full font-bold border-2 border-[#0A0910] transition-all duration-200 whitespace-nowrap text-sm"
                                :class="$route.path === '/table-design' ? 'bg-yellow-400 text-gray-800 shadow-md' : 'bg-white text-gray-700 hover:bg-gray-50 active:scale-95'"
                            >
                                <span>üçΩÔ∏è</span>
                                <span>Êª°Ê±âÂÖ®Â∏≠</span>
                            </router-link>
                            <router-link
                                to="/sauce-design"
                                @click="showMobileMenu = false"
                                class="flex items-center gap-1.5 px-3 py-2 rounded-full font-bold border-2 border-[#0A0910] transition-all duration-200 whitespace-nowrap text-sm"
                                :class="$route.path === '/sauce-design' ? 'bg-yellow-400 text-gray-800 shadow-md' : 'bg-white text-gray-700 hover:bg-gray-50 active:scale-95'"
                            >
                                <span>ü•Ñ</span>
                                <span>ÈÖ±ÊñôÂ§ßÂ∏à</span>
                            </router-link>
                            <router-link
                                to="/fortune-cooking"
                                @click="showMobileMenu = false"
                                class="flex items-center gap-1.5 px-3 py-2 rounded-full font-bold border-2 border-[#0A0910] transition-all duration-200 whitespace-nowrap text-sm"
                                :class="$route.path === '/fortune-cooking' ? 'bg-yellow-400 text-gray-800 shadow-md' : 'bg-white text-gray-700 hover:bg-gray-50 active:scale-95'"
                            >
                                <span>üîÆ</span>
                                <span>ÁéÑÂ≠¶Âé®Êàø</span>
                            </router-link>
                            <router-link
                                to="/favorites"
                                @click="showMobileMenu = false"
                                class="flex items-center gap-1.5 px-3 py-2 rounded-full font-bold border-2 border-[#0A0910] transition-all duration-200 whitespace-nowrap text-sm"
                                :class="$route.path === '/favorites' ? 'bg-yellow-400 text-gray-800 shadow-md' : 'bg-white text-gray-700 hover:bg-gray-50 active:scale-95'"
                            >
                                <span>‚ù§Ô∏è</span>
                                <span>ÊàëÁöÑÊî∂Ëóè</span>
                            </router-link>
                            <router-link
                                to="/gallery"
                                @click="showMobileMenu = false"
                                class="flex items-center gap-1.5 px-3 py-2 rounded-full font-bold border-2 border-[#0A0910] transition-all duration-200 whitespace-nowrap text-sm"
                                :class="$route.path === '/gallery' ? 'bg-yellow-400 text-gray-800 shadow-md' : 'bg-white text-gray-700 hover:bg-gray-50 active:scale-95'"
                            >
                                <span>üñºÔ∏è</span>
                                <span>Â∞ÅÁ•ûÂõæÈâ¥</span>
                            </router-link>
                            <router-link
                                to="/about"
                                @click="showMobileMenu = false"
                                class="flex items-center gap-1.5 px-3 py-2 rounded-full font-bold border-2 border-[#0A0910] transition-all duration-200 whitespace-nowrap text-sm"
                                :class="$route.path === '/about' ? 'bg-yellow-400 text-gray-800 shadow-md' : 'bg-white text-gray-700 hover:bg-gray-50 active:scale-95'"
                            >
                                <span>üìñ</span>
                                <span>ÂÖ≥‰∫éÊàë‰ª¨</span>
                            </router-link>
                        </div>
                    </div>

                    <!-- ÊªöÂä®ÊèêÁ§∫ -->
                    <div class="text-center text-xs text-gray-500 mt-1">‚Üê Â∑¶Âè≥ÊªëÂä®Êü•ÁúãÊõ¥Â§öÂäüËÉΩ ‚Üí</div>
                </div>
            </div>
        </div>
    </nav>
</template>

<script setup lang="ts">
import { ref, computed } from 'vue'
import { useRoute } from 'vue-router'
import SettingsButton from './SettingsButton.vue'

const showMobileMenu = ref(false)
const showMoreMenu = ref(false)
const isLogoRotating = ref(false)
let hideMenuTimer: NodeJS.Timeout | null = null

const rotateLogo = () => {
    isLogoRotating.value = true
    setTimeout(() => {
        isLogoRotating.value = false
    }, 500)
}
const route = useRoute()

// Ê†πÊçÆÂΩìÂâçË∑ØÁî±ÊòæÁ§∫‰∏çÂêåÁöÑÈ°µÈù¢Ê†áÈ¢ò
const pageTitle = computed(() => {
    switch (route.path) {
        case '/':
            return '‰∏ÄÈ•≠Â∞ÅÁ•û'
        case '/today-eat':
            return '‰ªäÊó•ÂêÉÂï•'
        case '/table-design':
            return '‰∏ÄÊ°åÂ•ΩËèúÂ∏à'
        case '/how-to-cook':
            return 'ËèúË∞±ÊåáÂçó'
        case '/sauce-design':
            return 'ÈÖ±ÊñôËÆæËÆ°Â§ßÂ∏à'
        case '/fortune-cooking':
            return 'ÁéÑÂ≠¶Âé®Êàø'
        case '/favorites':
            return 'ÊàëÁöÑÊî∂Ëóè'
        case '/gallery':
            return 'Â∞ÅÁ•ûÂõæÈâ¥'
        case '/about':
            return 'ÂÖ≥‰∫é‰∏ÄÈ•≠Â∞ÅÁ•û'
        default:
            return '‰∏ÄÈ•≠Â∞ÅÁ•û'
    }
})

const pageSubtitle = computed(() => {
    switch (route.path) {
        case '/':
            return 'ÁÅ∂Èó¥ÊúâAIÔºåÈ°øÈ°øÁ±≥ÂÖ∂ÊûóÔºÅ'
        case '/today-eat':
            return "Áõ≤ÁõíÁæéÈ£üÔºö'Áªù‰∫ÜÔºÅ' or 'ÂØÑ‰∫ÜÔºÅ'"
        case '/table-design':
            return 'ËÆ©ÊØèÈ°øÈ•≠ÔºåÈÉΩÊúâÂâßÊú¨ÔºÅ'
        case '/how-to-cook':
            return 'AIÂ§ßÂ∏àÊâãÊääÊâãÊïôÂ≠¶ÔºÅ'
        case '/sauce-design':
            return '‰∏ì‰∏öÈÖ±ÊñôÂà∂‰ΩúÔºåË∞ÉÂë≥ÁÅµÈ≠ÇÂçáÂçéÔºÅ'
        case '/fortune-cooking':
            return 'ÊòüËæ∞ÊåáÂºïÁæéÈ£üÔºåÂç†ÂçúÈ¢ÑËßÅÁæéÂë≥ÔºÅ'
        case '/favorites':
            return 'ÁèçËóèÁæéÂë≥ÔºåÈöèÊó∂ÂõûÂë≥ÔºÅ'
        case '/gallery':
            return 'ÊØè‰∏ÄÂ∏ßÈÉΩÊòØÂé®Ëâ∫ÁöÑÂ∞ÅÁ•ûÊó∂ÂàªÔºÅ'
        case '/about':
            return 'ÁÆóÊ≥ïÁÉπ‰∏áÁâ©Ôºå‰∏ÄÈîÆÂç≥Â∞ÅÁ•ûÔºÅ'
        default:
            return 'LEGENDARY STATUS FROM A SINGLE MEAL!'
    }
})

// Ê£ÄÊü•Êõ¥Â§öËèúÂçï‰∏≠ÁöÑÈ°µÈù¢ÊòØÂê¶Â§Ñ‰∫éÊ¥ªË∑ÉÁä∂ÊÄÅ
const isMoreMenuActive = computed(() => {
    return ['/favorites', '/gallery', '/about'].includes(route.path)
})

// Â§ÑÁêÜÈº†Ê†áËøõÂÖ•‰∫ã‰ª∂
const handleMouseEnter = () => {
    if (hideMenuTimer) {
        clearTimeout(hideMenuTimer)
        hideMenuTimer = null
    }
    showMoreMenu.value = true
}

// Â§ÑÁêÜÈº†Ê†áÁ¶ªÂºÄ‰∫ã‰ª∂
const handleMouseLeave = () => {
    hideMenuTimer = setTimeout(() => {
        showMoreMenu.value = false
    }, 150) // 150msÂª∂ËøüÔºåÁªôÁî®Êà∑Ë∂≥Â§üÊó∂Èó¥ÁßªÂä®Èº†Ê†á
}
</script>

<style scoped>
/* LogoÊóãËΩ¨Âä®Áîª */
@keyframes rotate {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

.rotate-logo {
    animation: rotate 0.5s ease-out;
}

/* ÁßªÂä®Á´ØËèúÂçïÂ±ïÂºÄÂä®Áîª */
@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.flex {
    animation: slideDown 0.3s ease-out;
}

/* ‰∏ãÊãâËèúÂçïÂä®Áîª */
@keyframes dropDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.absolute {
    animation: dropDown 0.2s ease-out;
}

/* ÈöêËóèÊªöÂä®Êù° */
.scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
}

.scrollbar-hide::-webkit-scrollbar {
    display: none;
}
</style>
